@model Exoticamp.UI.Models.EventCart.EventCartVM

@{
    ViewData["Title"] = "AddCampsite";
    Layout = "~/Views/Shared/_LayoutLandingPage.cshtml";
}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />

<div class="text-left mt-3">
    <a asp-action="Index" class="btn btn-secondary">Back to List</a>
</div>
<h4 style="text-align:center;margin-top:30px;">Add To Cart</h4>
<div class="row justify-content-center">
    <div class="col-md-4">
        <form id="addEventCartForm" asp-action="AddEventCart">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>

            <div class="form-group">
                <label asp-for="CustomerName" class="control-label">Customer Name:</label>
                <input asp-for="CustomerName" class="form-control" readonly />
                <span asp-validation-for="CustomerName" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Email" class="control-label">Email:</label>
                <input asp-for="Email" class="form-control" readonly />
                <span asp-validation-for="Email" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="CheckIn" class="control-label"></label> <span class="text-danger">*</span>
                <input asp-for="CheckIn" class="form-control" type="date" id="CheckIn" required />
                <span asp-validation-for="CheckIn" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="CheckOut" class="control-label"></label> <span class="text-danger">*</span>
                <input asp-for="CheckOut" class="form-control" type="date" id="CheckOut" required />
                <span asp-validation-for="CheckOut" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="NoOfAdults" class="control-label">No. of Adults:</label>
                <input asp-for="NoOfAdults" id="noOfAdults" class="form-control" min="0" step="1" />
                <span asp-validation-for="NoOfAdults" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="NoOfChildrens" class="control-label">No. of Children:</label>
                <input asp-for="NoOfChildrens" id="noOfChildrens" class="form-control" min="0" step="1" />
                <span asp-validation-for="NoOfChildrens" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="TotalPrice" class="control-label">Total Price:</label>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">₹</span>
                    </div>
                    <input asp-for="TotalPrice" id="totalPrice" class="form-control" readonly />
                </div>
                <span asp-validation-for="TotalPrice" class="text-danger"></span>
            </div>
            <div class="form-group">
                <input asp-for="EventId" class="form-control" type="hidden" value="@ViewBag.Events.EventId" />
            </div>
            <div class="form-group">
                <input asp-for="PriceForAdults" class="form-control" type="hidden" id="PriceForAdults" value="@Model.PriceForAdults" />
                <span asp-validation-for="PriceForAdults" class="text-danger"></span>
            </div>
            <div class="form-group">
                <input asp-for="PriceForChildrens" class="form-control" type="hidden" id="PriceForChildrens" value="@Model.PriceForChildrens" />
                <span asp-validation-for="PriceForChildrens" class="text-danger"></span>
            </div>

            <div class="form-group text-center" style="margin-top:10px;" >
                <input type="submit" value="Add To Cart" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>



@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script>
        $(document).ready(function () {
            var successMessage = '@TempData["SuccessMessage"]';
            var errorMessage = '@TempData["ErrorMessage"]';

            if (successMessage !== '') {
                toastr.success(successMessage);
            }

            if (errorMessage !== '') {
                toastr.error(errorMessage);
            }
        });
     </script>

    <script>
        // Function to update total price based on number of adults and children
        function updateTotalPrice() {
            var noOfAdults = parseInt($('#noOfAdults').val()) || 0;
            var noOfChildrens = parseInt($('#noOfChildrens').val()) || 0;
            var priceForAdults = parseFloat($('#PriceForAdults').val());
            var priceForChildrens = parseFloat($('#PriceForChildrens').val());

            var totalPrice = (noOfAdults * priceForAdults) + (noOfChildrens * priceForChildrens);

            $('#totalPrice').val(totalPrice.toFixed(2)); // Display total price with 2 decimal places
        }

        // Event listeners for input changes
        $('#noOfAdults, #noOfChildrens').on('input', function () {
            updateTotalPrice();
        });

        // Initial calculation when the page loads
        $(document).ready(function () {
            updateTotalPrice();
        });

        // Optional: If you want to prevent non-numeric input in number fields
        $('#noOfAdults, #noOfChildrens').on('keypress', function (event) {
            var charCode = event.which ? event.which : event.keyCode;
            if (charCode > 31 && (charCode < 48 || charCode > 57)) {
                event.preventDefault();
            }
        });
    </script>
}
